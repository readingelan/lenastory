<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadowing Practice â€“ Snow White</title>

<style>
  body {
    margin: 0;
    padding: 20px;
    background: #0e0e0e;
    color: #eee;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }

  .container {
    max-width: 720px;
    margin: 0 auto;
  }

  .video-wrapper {
    position: relative;
    padding-top: 56.25%;
    margin-bottom: 20px;
  }

  .video-wrapper iframe {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }

  .shadow-box {
    background: #1c1c1c;
    border-radius: 16px;
    padding: 26px;
    text-align: center;
  }

  .title {
    font-size: 2rem;
    font-weight: 800;
    margin-bottom: 10px;
    letter-spacing: -0.02em;
  }

  .subtitle {
    font-size: 1rem;
    color: #bbb;
    margin-bottom: 18px;
  }

  .sentence {
    font-size: 1.4rem;
    line-height: 1.6;
    margin-bottom: 14px;
    min-height: 4.2em;
  }

  .status {
    font-size: 0.95rem;
    color: #aaa;
    margin-bottom: 18px;
  }

  .controls button,
  .modes button {
    font-size: 0.95rem;
    padding: 8px 12px;
    margin: 4px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
  }

  .modes {
    margin-bottom: 14px;
  }

  .active {
    background: #444;
    color: #fff;
  }

  .progress {
    margin-top: 10px;
    font-size: 0.85rem;
    color: #888;
  }
</style>
</head>

<body>
<div class="container">

  <!-- ì˜ìƒ -->
  <div class="video-wrapper">
    <iframe
      id="player"
      src="https://www.youtube.com/embed/XyuuezDhQgs?enablejsapi=1&start=61"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  </div>

  <!-- ì‰ë„ì‰ ë°•ìŠ¤ -->
  <div class="shadow-box">

    <!-- íƒ€ì´í‹€ ì˜ì—­ -->
    <div id="titleBox">
      <div class="title">ë°•ì •í˜„ ë”°ë¼í•˜ë¦¬ë‚˜ âœï¸ğŸ“–ğŸ§</div>
      <div class="subtitle">English Shadowing Practice</div>
    </div>

    <!-- ëª¨ë“œ ì„ íƒ -->
    <div class="modes">
      <button onclick="setMode(1)" id="mode1">1. Full</button>
      <button onclick="setMode(2)" id="mode2">2. Blanks</button>
      <button onclick="setMode(3)" id="mode3">3. Hidden</button>
    </div>

    <div class="sentence" id="sentenceBox"></div>
    <div class="status" id="statusText">â­ Press next to start</div>

    <div class="controls">
      <button onclick="prevSentence()">â®</button>
      <button onclick="playSentence()">â–¶</button>
      <button onclick="repeatSentence()">ğŸ”</button>
      <button onclick="nextSentence()">â­</button>
    </div>

    <div class="progress" id="progressText"></div>
  </div>

</div>

<script>
  let player;
  let currentIndex = -1; // íƒ€ì´í‹€ ìƒíƒœ
  let stopTimer;
  let mode = 1;

  const sentences = [
    { text: "Snow White and the Seven Dwarfs", start: 61, end: 64 },
    { text: "Once upon a time, a princess was born in a kingdom far away.", start: 64, end: 68 },
    { text: "The Queen had long wished for a daughter with skin like snow.", start: 68, end: 73 },
    { text: "Her wish had come true, and she named the princess Snow White.", start: 73, end: 78 },
    { text: "Sadly, the Queen passed away not long after Snow White was born.", start: 78, end: 84 }
  ];

  function onYouTubeIframeAPIReady() {
    player = new YT.Player("player");
    updateUI();
  }

  function playSentence() {
    if (currentIndex < 0) return;

    clearTimeout(stopTimer);
    const s = sentences[currentIndex];
    statusText.innerText = "â–¶ Listening...";
    player.seekTo(s.start, true);
    player.playVideo();

    stopTimer = setTimeout(() => {
      player.pauseVideo();
      statusText.innerText = "ğŸ¤ Now shadow the sentence";
    }, (s.end - s.start) * 1000);
  }

  function repeatSentence() {
    playSentence();
  }

  function nextSentence() {
    if (currentIndex < sentences.length - 1) {
      currentIndex++;
      updateUI();
    }
  }

  function prevSentence() {
    if (currentIndex > -1) {
      currentIndex--;
      updateUI();
    }
  }

  function setMode(m) {
    mode = m;
    document.querySelectorAll(".modes button").forEach(b => b.classList.remove("active"));
    document.getElementById(`mode${m}`).classList.add("active");
    updateSentence();
  }

  function updateSentence() {
    if (currentIndex < 0) {
      sentenceBox.innerText = "";
      return;
    }

    const text = sentences[currentIndex].text;

    if (mode === 1) {
      sentenceBox.innerText = text;
    } else if (mode === 2) {
      sentenceBox.innerText = text.replace(/\b(\w{4,})\b/g, "____");
    } else {
      sentenceBox.innerText = "";
    }
  }

  function updateUI() {
    if (currentIndex < 0) {
      titleBox.style.display = "block";
      statusText.innerText = "â­ Press next to start";
      progressText.innerText = "";
    } else {
      titleBox.style.display = "none";
      updateSentence();
      statusText.innerText = "â–¶ Press play to listen";
      progressText.innerText = `Sentence ${currentIndex + 1} / ${sentences.length}`;
    }
  }

  const tag = document.createElement("script");
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);

  setMode(1);
</script>

</body>
</html>
