<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadowing Practice ‚Äì Snow White</title>

<style>
  body {
    margin: 0;
    padding: 20px;
    background: #0e0e0e;
    color: #eee;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }

  .container {
    max-width: 720px;
    margin: 0 auto;
  }

  .video-wrapper {
    position: relative;
    padding-top: 56.25%;
    margin-bottom: 20px;
  }

  .video-wrapper iframe {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }

  .shadow-box {
    background: #1c1c1c;
    border-radius: 14px;
    padding: 24px;
    text-align: center;
  }

  .sentence {
    font-size: 1.4rem;
    line-height: 1.6;
    margin-bottom: 14px;
    min-height: 4.2em;
  }

  .status {
    font-size: 0.95rem;
    color: #aaa;
    margin-bottom: 18px;
  }

  .controls button,
  .modes button {
    font-size: 0.95rem;
    padding: 8px 12px;
    margin: 4px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
  }

  .modes {
    margin-bottom: 14px;
  }

  .active {
    background: #444;
    color: #fff;
  }

  .progress {
    margin-top: 10px;
    font-size: 0.85rem;
    color: #888;
  }
</style>
</head>

<body>
<div class="container">

  <!-- ÏòÅÏÉÅ -->
  <div class="video-wrapper">
    <iframe
      id="player"
      src="https://www.youtube.com/embed/XyuuezDhQgs?enablejsapi=1&start=61"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  </div>

  <!-- ÏâêÎèÑÏûâ Î∞ïÏä§ -->
  <div class="shadow-box">

    <!-- Î™®Îìú ÏÑ†ÌÉù -->
    <div class="modes">
      <button onclick="setMode(1)" id="mode1">1. Full</button>
      <button onclick="setMode(2)" id="mode2">2. Blanks</button>
      <button onclick="setMode(3)" id="mode3">3. Hidden</button>
    </div>

    <div class="sentence" id="sentenceBox"></div>
    <div class="status" id="statusText">‚ñ∂ Press play to listen</div>

    <div class="controls">
      <button onclick="prevSentence()">‚èÆ</button>
      <button onclick="playSentence()">‚ñ∂</button>
      <button onclick="repeatSentence()">üîÅ</button>
      <button onclick="nextSentence()">‚è≠</button>
    </div>

    <div class="progress" id="progressText"></div>
  </div>

</div>

<script>
  let player;
  let currentIndex = 0;
  let stopTimer;
  let mode = 1;

  const sentences = [
    { text: "Once upon a time, a princess was born in a kingdom far away.", start: 61, end: 65 },
    { text: "The Queen had long wished for a daughter with skin like snow.", start: 65, end: 70 },
    { text: "Her wish had come true, and she named the princess Snow White.", start: 70, end: 75 },
    { text: "Sadly, the Queen passed away not long after Snow White was born.", start: 75, end: 81 }
  ];

  function onYouTubeIframeAPIReady() {
    player = new YT.Player("player");
    updateUI();
  }

  function playSentence() {
    clearTimeout(stopTimer);
    const s = sentences[currentIndex];
    statusText.innerText = "‚ñ∂ Listening...";
    player.seekTo(s.start, true);
    player.playVideo();

    stopTimer = setTimeout(() => {
      player.pauseVideo();
      statusText.innerText = "üé§ Now shadow the sentence";
    }, (s.end - s.start) * 1000);
  }

  function repeatSentence() {
    playSentence();
  }

  function nextSentence() {
    if (currentIndex < sentences.length - 1) {
      currentIndex++;
      updateUI();
    }
  }

  function prevSentence() {
    if (currentIndex > 0) {
      currentIndex--;
      updateUI();
    }
  }

  function setMode(m) {
    mode = m;
    document.querySelectorAll(".modes button").forEach(b => b.classList.remove("active"));
    document.getElementById(`mode${m}`).classList.add("active");
    updateSentence();
  }

  function updateSentence() {
    const text = sentences[currentIndex].text;

    if (mode === 1) {
      sentenceBox.innerText = text;
    } else if (mode === 2) {
      sentenceBox.innerText = text.replace(/\b(\w{4,})\b/g, "____");
    } else {
      sentenceBox.innerText = "";
    }
  }

  function updateUI() {
    updateSentence();
    statusText.innerText = "‚ñ∂ Press play to listen";
    progressText.innerText = `Sentence ${currentIndex + 1} / ${sentences.length}`;
  }

  const tag = document.createElement("script");
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);

  setMode(1);
</script>

</body>
</html>
